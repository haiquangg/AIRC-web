<!DOCTYPE html>
<html>
  <head>
    <title>River Vision</title>
    <link href="../static/styles.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/" rel="preconnect" />
    <link
      href="https://fonts.gstatic.com/"
      rel="preconnect"
      crossorigin="anonymous"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <script>
      WebFont.load({ google: { families: ["Inter:regular,500,700,800"] } });
    </script>
  </head>
  <body>
    <div style="opacity: 1" class="page-wrapper">
      <div class="header-wrapper w-nav">
        <div class="container-default w-container">
          <div class="header-content-wrapper">
            <a
              href="/index"
              aria-current="page"
              class="logo-link-wrapper w-nav-brand w--current"
              aria-label="home"
              ><h1 class="text-400 bold">River Vision</h1></a
            >
            <nav
              class="header-nav-menu-wrapper w-nav-menu"
              style="transform: translateY(0px) translateX(0px)"
            >
              <ul role="list" class="header-nav-menu-list w-list-unstyled">
                <li class="header-nav-list-item">
                  <a
                    href="/index"
                    class="header-nav-link w-nav-link"
                    style="max-width: 1268px"
                    >Trang Chủ</a
                  >
                </li>
                <li class="header-nav-list-item">
                  <a
                    href="/intro"
                    class="header-nav-link w-nav-link"
                    style="max-width: 1268px"
                    >Giới Thiệu</a
                  >
                </li>
                <li class="header-nav-list-item">
                  <a
                    href="/tool"
                    aria-current="page"
                    class="header-nav-link w-nav-link w--current"
                    style="max-width: 1268px"
                    >Công Cụ</a
                  >
                </li>
              </ul>
              <div class="header-sidebar-wrapper">
                <div class="sidebar-container">
                  <div class="text-50 medium sidebar-title">Menu</div>
                  <div class="grid-1-column sidebar-links-grid mg-bottom-48px">
                    <a href="/index" class="sidebar-link w-inline-block">
                      <img
                        src="../static/icon/645990a11b8dbb8a2114ab99_home-sidebar-link-icon-dashflow-webflow-template.png"
                        loading="eager"
                        alt="Home - Dashflow X Webflow Template"
                        class="max-w-20px"
                      />
                      <div class="text-100 medium">Trang Chủ</div>
                    </a>
                    <a href="/intro" class="sidebar-link w-inline-block">
                      <img
                        src="../static/icon/645990a1fc639065b23f0dc9_changelog-sidebar-link-icon-dashflow-webflow-template.png"
                        loading="eager"
                        alt="Changelog - Dashflow X Webflow Template"
                        class="max-w-20px"
                      />
                      <div class="text-100 medium">Giới Thiệu</div>
                    </a>
                    <a
                      href="/tool"
                      aria-current="page"
                      class="sidebar-link w-inline-block w--current"
                      ><img
                        src="../static/icon/645990a10f4b932ada158349_licenses-sidebar-link-icon-dashflow-webflow-template.png"
                        loading="eager"
                        alt="Licenses - Dashflow X Webflow Template"
                        class="max-w-20px"
                      />
                      <div class="text-100 medium">Công Cụ</div></a
                    >
                  </div>
                  <div class="text-50 medium sidebar-title">Giới Thiệu</div>
                  <div class="grid-1-column sidebar-links-grid"></div>
                </div>
              </div>
            </nav>
            <div class="header-right-side-container">
              <div class="hidden-on-mbl">
                <div class="buttons-row gap-column-12px">
                  <a href="/" class="btn-primary w-inline-block"
                    ><div class="flex-horizontal gap-column-4px">
                      <div id="logout-btn">Đăng Xuất</div>
                    </div></a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          class="w-nav-overlay"
          data-wf-ignore=""
          id="w-nav-overlay-0"
          style="display: none"
        ></div>
      </div>
      <div class="main-section pd-bottom-64px wf-section">
        <div class="container-default w-container">
          <div class="grid-2-columns main-dashboard-grid">
            <div class="sticky-top hidden-on-tablet">
              <div class="sidebar-container">
                <div class="text-50 medium sidebar-title">Menu</div>
                <div class="grid-1-column sidebar-links-grid mg-bottom-48px">
                  <a href="/index" class="sidebar-link w-inline-block">
                    <img
                      src="../static/icon/645990a11b8dbb8a2114ab99_home-sidebar-link-icon-dashflow-webflow-template.png"
                      loading="eager"
                      alt="Home - Dashflow X Webflow Template"
                      class="max-w-20px"
                    />
                    <div class="text-100 medium">Trang Chủ</div>
                  </a>
                  <a href="/intro" class="sidebar-link w-inline-block">
                    <img
                      src="../static/icon/645990a1fc639065b23f0dc9_changelog-sidebar-link-icon-dashflow-webflow-template.png"
                      loading="eager"
                      alt="Changelog - Dashflow X Webflow Template"
                      class="max-w-20px"
                    />
                    <div class="text-100 medium">Giới Thiệu</div>
                  </a>
                  <a
                    href="/tool"
                    aria-current="page"
                    class="sidebar-link w-inline-block w--current"
                    ><img
                      src="../static/icon/645990a10f4b932ada158349_licenses-sidebar-link-icon-dashflow-webflow-template.png"
                      loading="eager"
                      alt="Licenses - Dashflow X Webflow Template"
                      class="max-w-20px"
                    />
                    <div class="text-100 medium">Công Cụ</div></a
                  >
                </div>
              </div>
            </div>

            <div class="dashboard-main-content">
              <div style="opacity: 1" class="card image-right-inside">
                <div
                  class="flex flex-col justify-center items-center gap-6 mx-1 sm:mx-6 py-2"
                >
                  <div>
                    <h3
                      class="flexheading font-display font-bold text-typo m-0 text-4xl text-center"
                    >
                      Công cụ phân đoạn ảnh viễn thám
                    </h3>
                  </div>
                  <div>
                    <input
                      type="file"
                      id="image-input"
                      accept="image/*"
                      multiple
                    />
                    <button id="upload-btn">Tải lên</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="bg-neutral-100 wf-section">
        <div class="container-default w-container">
          <div class="grid-2-columns main-dashboard-grid">
            <div id="w-node-bdf375e4-f372-ad95-cceb-78bd47bb7446-47bb7443">
              <div class="footer-top-section">
                <a
                  href="/index"
                  aria-current="page"
                  class="logo-link-wrapper w-nav-brand w--current"
                  aria-label="home"
                  ><h1 class="text-400 bold">River Vision</h1></a
                >
                <div class="footer-links-container" style="opacity: 1">
                  <a href="/index" class="text-decoration-none">Trang Chủ</a>
                  <a href="/intro" class="text-decoration-none">Giới Thiệu</a>
                  <a
                    href="/tool"
                    aria-current="page"
                    class="text-decoration-none w--current"
                    >Công Cụ</a
                  >
                </div>
              </div>
              <div class="footer-bottom-section">
                <div style="opacity: 1">
                  Copyright © River Vision | Designed by
                  <a
                    href="https://brixtemplates.com/"
                    class="text-decoration-none text-bold"
                    target="_blank"
                    >AIRC</a
                  >
                  - Powered by
                  <a
                    href="https://brixtemplates.com/"
                    class="text-decoration-none text-bold"
                    target="_blank"
                    >Viện CNTT</a
                  >
                </div>
                <div class="social-links-container" style="opacity: 1">
                  <a
                    href="https://www.facebook.com/"
                    target="_blank"
                    class="social-circle-link"
                    ></a
                  ><a
                    href="https://www.twitter.com/"
                    target="_blank"
                    class="social-circle-link"
                    ></a
                  ><a
                    href="https://www.linkedin.com/"
                    target="_blank"
                    class="social-circle-link"
                    ></a
                  ><a
                    href="https://www.youtube.com/"
                    target="_blank"
                    class="social-circle-link"
                    ></a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="loading-bar-wrapper" style="display: none; opacity: 1">
      <div class="loading-bar" style="width: 100vw"></div>
    </div>
    <!-- Script của bạn -->
    <script src="../static/script.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
      // Đoạn script xử lý upload ảnh
      document.getElementById("upload-btn").addEventListener("click", function(e) {
        e.preventDefault();  // Ngăn form gửi theo mặc định

        const imageInput = document.getElementById("image-input");
        if (!imageInput.files.length) {
          alert("Vui lòng chọn ít nhất một ảnh!");
          return;
        }

        const formData = new FormData();
        // Thêm tất cả các file đã chọn vào FormData
        for (let i = 0; i < imageInput.files.length; i++) {
          formData.append("image", imageInput.files[i]);
        }

        // Gửi dữ liệu đến backend qua fetch
        fetch("/segment", { method: "POST", body: formData })
          .then((res) => res.json())
          .then((data) => {
            // Lưu dữ liệu trả về vào sessionStorage
            sessionStorage.setItem("original_images", JSON.stringify(data.original_images));
            sessionStorage.setItem("segmented_images", JSON.stringify(data.segmented_images));
            sessionStorage.setItem("predicted_image", data.predicted_image);
            sessionStorage.setItem("area", data.area);
            sessionStorage.setItem("execution_time", data.execution_time);
            
            // Chuyển sang trang kết quả
            window.location.href = "/result";
          })
          .catch((error) => {
            console.error("Error:", error);
          });
      });
    </script>
  </body>
</html>
